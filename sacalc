#!/usr/bin/env bash
# sacalc calculates source and destination size
. msg ck_size

srcsize=`eval rclone size "$src" --json | cut -d ":" -f3 | cut -d "}" -f1`
srcsizeGB=$(( $srcsize/1024**3 ))

destsize=`eval rclone size "$dest" --json | cut -d ":" -f3 | cut -d "}" -f1`
destsizeGB=$(( $destsize/1024**3 ))

diff=$(( $srcsize-$destsize ))
diffGB=$(( $diff/1024**3 ))

SRC_LIMIT=${SRC_LIMIT%%[A-Za-z]*}
LIM=${SRC_LIMIT:-$diffGB}
LIM=$((diffGB>LIM?LIM:diffGB))
MAXT=${maxt%%[A-Za-z]*}
SAs=$(( ($MAXT+${LIM#-})/$MAXT ))

. msg diff_size
